<div class="map-container" [style.width.px]="width" [style.height.px]="height" role="region" aria-label="Mapa de rutas">
  <google-map [center]="mapCenter" [zoom]="zoom" [height]="height + 'px'" [width]="width + 'px'">
    <!-- Marcador de usuario si está disponible -->
    <map-marker *ngIf="userMarker" [position]="userMarker" [title]="'Tu ubicación'"></map-marker>

    <!-- Centro de distribución -->
    <map-marker [position]="{ lat: center.lat, lng: center.lng }" [title]="'Centro de distribución'"></map-marker>

    <!-- Clientes -->
    <map-marker *ngFor="let c of clients" [position]="{ lat: c.lat, lng: c.lng }" [title]="c.name" (mapClick)="onStopClick(c)"></map-marker>

    <!-- Rutas por vehículo como polilíneas -->
    <map-polyline *ngFor="let r of routes" [path]="r.path" [options]="{ strokeColor: r.vehicle.color, strokeWeight: 3 }"></map-polyline>
  </google-map>

  <!-- Tooltip simple -->
  <div *ngIf="selectedStop() as s" class="tooltip">
    <div><strong>{{ s.name }}</strong></div>
    <div>{{ s.address }}</div>
    <div>ID pedido: {{ s.id }}</div>
    <div *ngIf="vehicleForStop(s) as v">Asignado a: {{ v }}</div>
  </div>
</div>
